{% extends "sakai/base.xhtml" %}

{% block pagetitle %}Meetings{% endblock %}

{% block content %}

<dl>
  <dt>Title</dt>
  <dd>{{ event.title }}</dd>
  <dt>Organiser</dt>
  <dd>{{ event.organizerName }}</dd>
  <dt>Location</dt>
  <dd>{{ event.location }}</dd>
</dl>

<table>
  <thead>
    <tr>
      <th>Timeslot</th>
      <th>Max participants</th>
      <th>Participants</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
{% for ts in event.signupTimeSlotItems %}
    <tr>
      <td>
        {{ ts.startTime }} - {{ ts.endTime }}
      </td>
      <td>{{ ts.maxNoOfAttendees }}</td>
      <td>
{% if ts.displayAttendees %}
        <ul>
{% for attendee in ts.attendees %}
          <li>{{ attendee.displayName }}</li>
{% endfor %}
        </ul>
{% else %}
        <em>private</em>
{% endif %}
      </td>
      <td>{% if ts.signedUp %}Signed up{% else %}{% if ts.onWaitList %}On waiting list{% endif %}{% endif %}</td>
      <td>
        <form method="post" action=".">
          <input type="hidden" name="timeslot_id" value="{{ ts.id }}"/>
{% if not event.meetingExpired and not event.passedDeadline and event.startToSignUp %}
  {% if ts.signedUp %}
          <button type="submit" name="action" value="cancelSignup">Cancel</button>
  {% else %}
    {% if ts.onWaitList %}
          <button type="submit" name="action" value="removeWaitList">Leave waiting list</button>
    {% else %}
      {% if ts.available %}
          <button type="submit" name="action" value="signup">Sign up</button>
      {% else %}      
          <button type="submit" name="action" value="addToWaitList">Join waiting list</button>
      {% endif %}
    {% endif %}
  {% endif %}
{% endif %}
        </form>
      </td>
    </tr>
{% endfor %}
  </tbody>
</table>

{% endblock %}